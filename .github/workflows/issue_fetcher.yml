name: Fetch Issue Details

on:
  issue_comment:
    types: [created]

jobs:
  fetch_issue_details:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v2

      - name: Set up GitHub CLI
        run: sudo apt-get install gh

      - name: Fetch issue details
        id: fetch_issue
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }} 
        run: |
          COMMENT_BODY="${{ github.event.comment.body }}"

         
          if [[ "$COMMENT_BODY" =~ ^#([0-9]+) ]]; then
            ISSUE_NUMBER="${BASH_REMATCH[1]}"
            echo "Fetching issue #$ISSUE_NUMBER"

            ISSUE_DATA=$(gh issue view $ISSUE_NUMBER --json title,state,body --jq '.')
            echo "ISSUE_DATA=$ISSUE_DATA" >> $GITHUB_ENV
          else
            echo "No valid issue reference found in comment."
            exit 0

      - name: Output issue details
        run: echo "Fetched Issue Details: ${{ env.ISSUE_DATA }}"
